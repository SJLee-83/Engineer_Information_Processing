#include <stdio.h>
char n[30];
char* getname() {
    printf("이름 입력 : ");
    // gets(n);
     fgets(n, 30, stdin);
    return n;
}

main() {
    char* n1 = getname();
    char* n2 = getname();
    char* n3 = getname();
    printf("%s\n", n1);
    printf("%s\n", n2);
    printf("%s\n", n3);
}

// ## gets() 함수가 에러인 이유 🚨
// 사용자님이 보신 에러는 gets() 함수가 매우 위험해서 현재는 C언어 표준(C11)에서 공식적으로 퇴출(deprecated)되었기 때문입니다. 
// 최신 컴파일러는 이 함수를 만나면 보안상의 이유로 에러를 발생시킵니다.

//     gets()는 있는 함수인가?: 예, 과거에는 C 표준 라이브러리 함수였습니다.

//     위험한 이유 (버퍼 오버플로우): gets() 함수는 입력을 받을 때, n[30]이라는 배열의 크기를 확인하지 않습니다. 
//     만약 사용자가 30자 이상, 예를 들어 100자를 입력하면, n 배열에 할당된 메모리 공간(30바이트)을 넘어서 다른 중요한 메모리 영역을 덮어쓰게 됩니다.

//     결과: 이로 인해 프로그램이 비정상적으로 종료되거나, 해커가 이 취약점을 이용해 악성 코드를 심을 수 있습니다. 이를 버퍼 오버플로우(Buffer Overflow) 공격이라고 합니다.

//     안전한 대안: gets() 대신 항상 fgets() 함수를 사용해야 합니다. fgets(n, 30, stdin);처럼 사용하면 최대 30자(정확히는 29자 + \0)까지만 입력을 받아 안전합니다.


// ## (가상) 코드 실행 과정 및 결과
// 만약 gets()가 fgets()로 대체되어 코드가 정상적으로 실행된다고 가정했을 때, 이 코드의 핵심은 n이 '글로벌 변수'라는 점입니다.

// n[30]은 모든 함수가 공유하는 단 하나의 저장 공간입니다. n1, n2, n3는 각각 별개의 저장 공간을 갖는 것이 아니라, 모두 똑같은 n이라는 하나의 저장 공간을 가리키는 포인터일 뿐입니다.

//     char* n1 = getname();

//         getname() 함수가 호출됩니다. "이름 입력 : "이 출력됩니다.

//         사용자가 "Kim"을 입력합니다.

//         **글로벌 변수 n**의 값은 "Kim"이 됩니다.

//         n의 주소가 반환되고, n1은 "Kim"이 저장된 n의 주소를 가리킵니다.

//     char* n2 = getname();

//         getname() 함수가 다시 호출됩니다. "이름 입력 : "이 출력됩니다.

//         사용자가 "Lee"를 입력합니다.

//         **글로벌 변수 n**의 값이 "Lee"로 덮어쓰기됩니다. (이제 "Kim"은 사라졌습니다.)

//         n의 주소가 반환되고, n2는 "Lee"가 저장된 n의 주소를 가리킵니다.

//         중요: n1도 여전히 n의 주소를 가리키고 있으므로, n1이 가리키는 값도 "Lee"로 변경됩니다.

//     char* n3 = getname();

//     getname() 함수가 세 번째로 호출됩니다. "이름 입력 : "이 출력됩니다.

//         사용자가 "Park"을 입력합니다.

//         **글로벌 변수 n**의 값이 "Park"으로 덮어쓰기됩니다.

//         n3는 "Park"이 저장된 n의 주소를 가리킵니다.

//         결과: n1, n2, n3 모두 "Park"이 저장된 동일한 n의 주소를 가리키게 됩니다.

//     printf 실행

//         printf("%s\n", n1); : n1이 가리키는 n의 값 "Park" 출력

//         printf("%s\n", n2); : n2가 가리키는 n의 값 "Park" 출력

//         printf("%s\n", n3); : n3가 가리키는 n의 값 "Park" 출력